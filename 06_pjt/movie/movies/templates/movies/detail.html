{% extends "base.html" %}

{% block content %}
<h1>DETAIL PAGE</h1>
<div class="card" style="width: 18rem;">
  <div class="card-body">
    <h5 class="card-title">{{ movie.title }}</h5>
    <p class="card-text">{{ movie.description }}</p>
  </div>
</div>
<hr>

<h3>댓글 목록</h3>
{% if movie.comment_set.all %}
  {% for comment in movie.comment_set.all %}
    <div class="d-flex justify-content-between align-items-center p-2 border">
      <p class="m-0">{{ comment.content }}</p>
      <div class="d-flex">
        <p class="m-0 me-3">작성자 : <a href="{% url "accounts:profile" comment.user.pk %}">{{ comment.user.username }}</a></p>
        {% if comment.user == request.user %}
          <form action="{% url "movies:comments_delete" movie.pk comment.pk %}" method="POST">
            {% csrf_token %}
            <input type="submit" value="DELETE" style="font-size:10px;" class="btn btn-outline-danger">
          </form>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% else %}
  <p>아직 댓글이 없네요..</p>
{% endif %}
<hr>

<form action="{% url "movies:comments_create" movie.pk %}" method="POST" class="d-flex">
  {% csrf_token %}
  {{ form }}
  <input type="submit" value="SUBMIT" class="btn btn-outline-success justify-content-end ms-3">
</form>

<div class="mt-3">
  <a href="{% url "movies:update" movie.pk %}" class="btn btn-outline-primary">UPDATE</a>
  <a href="{% url "movies:delete" movie.pk %}" class="btn btn-outline-danger">DELETE</a>
  <a href="{% url "movies:index" %}" class="btn btn-outline-secondary">BACK</a>
</div>
{% endblock content %}